<!doctype html>
<html ng-app>
	<head>
		<title>Hello AngularJS</title>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    	<script>
				function Switches($scope, $http) {
				  $http.get('http://localhost:5000/api/switches').
				  success(function(data) {
				    console.log(data.switches[0]);
				    $scope.switches = data;
				  });
          $scope.updateSwitch = function (x) {
            $http.put("http://localhost:5000/api/switches/" + this.switch.id, { 'state': x.toElement.checked }).success(function(result) {
              console.log(result);
              $scope.resultPut = result;
            }).error(function() {
              console.log("error");
            });

          }
				}
			</script>
	</head>

	<body>
    <nav class="navbar navbar-default">
      <div class="container">
        <a class="navbar-brand text-center center-block" style="float: none;" href="#">Lights</a>
      </div>
    </nav>
</nav>
    <div class="container-fluid">
  		<ul class="list-group" ng-controller="Switches">
        <li class="list-group-item" ng-repeat="switch in switches.switches">
          <label for="switch-{{ switch.id }}" style="width: 100%;"> {{ switch.name }}
          <input id="switch-{{ switch.id }}" class="pull-right" type="checkbox" name="" ng-click="updateSwitch($event)" ng-checked="switch.state">
          </label>
        </li>
  		</ul>
    </div>
	</body>
</html>
